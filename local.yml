- hosts: nowa
  become: true

  vars:
#    kasnet_ver: "2.1.339-m01"
#    xkasnet_ver: "2.2.19"
    repo_url: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32326237646638373062653563316234303065613165316432626232636236656137333633333234
          3937363035363961306233666539643938626134316538660a336665376362636535386262336336
          32303830353563366263323939323438643731363038373338326333346361343330333366643933
          3562633538306433310a373162306164646239646633633338666332313536366332336638616530
          39303231663266633631343733303239373866663538366563623264646163353137

    repo_login: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31363132306531623636386438663061653332613436326538303834396461323938656332613239
          3965666466616431333562333732383330653264616134330a326463313861393734373965643633
          32313964323137643763313938316238366533323438663062653638613939343338633336373366
          3631316438343461640a333064316664313239313936373031653536396163366634656130653138
          6231

    repo_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33323933383635633163653466343366616635616632336564373961313164646535643561646332
          6136356166363130613966613635313663396162323966620a623366303930396165353730326332
          34323462613633326437343731373238373031306138393264386161336661356131643630383731
          3734343362356466640a646533396637353631636630393662366132376364353161333862333661
          3862         

    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63643833653333363236663066313462613634393263666538636337393035343038393837376162
          6330323433623235373036663533616531643932613836340a616133383137363937346332396130
          35366631386633383164663434306137363166373330356163386165663665663236363961356134
          3162633162636334630a366263316562613163346131656233343332366163666239373762343666
          6464

  tasks:

    - set_fact:
        ansible_python_interpreter: /usr/bin/python3
  
    - name: Sprawdzanie systemu
      fail: msg="System operacyjny to nie UBUNTU 22"
      when: ansible_distribution != "Ubuntu" and ansible_distribution_major_version | int  != 22

#    - name: Zmiana hostname na kasaX    
#      hostname:
#        name: kasaX

    - import_tasks: repo.yml    

    - import_tasks: pakiety.yml
 
    - import_tasks: konfiguracja.yml
    
#    - import_tasks: sterowniki.yml

    - name: Informacja
      debug:
        msg: "Instalacja zostala zakonczona. Komputer zostanie automatycznie zrestartowany. Prosze czekac..."

    - pause:
        seconds: 5

    - name: Restart komputera
      command: reboot
